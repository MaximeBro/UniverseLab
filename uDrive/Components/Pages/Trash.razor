@page "/trash"
@inherits AuthorizedComponentBase

<PageTitle>uDrive</PageTitle>
<AuthorizeView>
    <Authorized>
        <MudContainer Class="pt-3" MaxWidth="MaxWidth.ExtraLarge">
            <MudGrid Spacing="5" Justify="Justify.FlexStart">
                <MudItem xs="12">
                    <MudStack Class="px-3 py-2 background-800 rounded-xl mud-elevation-5" Spacing="1" Row Justify="Justify.FlexStart" AlignItems="AlignItems.Center">
                        <MudTooltip Class="background-500 tooltip-arrow" Placement="Placement.Bottom" Text="@SelectButtonTooltip" Arrow>
                            <MudIconButton Class="pa-1" Icon="@SelectButtonIcon" OnClick="@HandleSelection"/>
                        </MudTooltip>
                        <MudTooltip Class="background-500 tooltip-arrow" Placement="Placement.Bottom" Text="Actualiser" Arrow>
                            <MudIconButton Class="pa-1" Icon="@Icons.Rounded.Refresh" OnClick="@RefreshDataAsync"/>
                        </MudTooltip>
                        @if (SelectedItems.Count > 0)
                        {
                            <MudTooltip Class="background-500 tooltip-arrow" Placement="Placement.Bottom" Text="Restaurer" Arrow>
                                <MudIconButton Class="pa-1" Icon="@Icons.Rounded.Outbox" OnClick="@RestoreAsync"/>
                            </MudTooltip>
                            <MudTooltip Class="background-500 tooltip-arrow" Placement="Placement.Bottom" Text="Supprimer" Arrow>
                                <MudIconButton Class="pa-1" Icon="@Icons.Rounded.DeleteOutline" OnClick="@ForciblyDeleteAsync"/>
                            </MudTooltip>
                        }
                        <MudText Class="ml-1">@SelectedItemsText</MudText>
                    </MudStack>
                </MudItem>
                @foreach (var item in _items)
                {
                    <MudItem xs="6" sm="4" md="3" lg="2" xl="2">
                        <MudStack Row="false" Spacing="2">
                            <MudPaper Class="@($"d-flex flex-row gap-2 background-800 pa-4 rounded-lg border {ItemClass(item)}")"
                                      Style="@($"position: relative; cursor: pointer; border-color: {ItemStyle(item)};")" Elevation="5"
                                      @onmouseenter="@(() => item.Hovered = true)"
                                      @onmouseleave="@(() => item.Hovered = false)"
                                      @onmouseup="@(() => item.Selected = !item.Selected)">
                                <MudIcon Icon="@item.Icon()" Style="@($"color: {item.Color}!important;")"/>
                                <MudText>@item.Name</MudText>
                            </MudPaper>
                            <MudText Class="px-3" Style="@($"font-size: 14px; font-style: italic; {(item.Selected ? "text-decoration: line-through;" : string.Empty)}")">
                                Depuis le @item.LastEditedAt.ToString("dd/MM/yyyy")
                            </MudText>
                        </MudStack>
                    </MudItem>
                }
            </MudGrid>
        </MudContainer>
    </Authorized>
</AuthorizeView>
